#include <bits/stdc++.h>
using namespace std;
class User{
protected:
    string name;
    string username;
    string password;
    string phoneNumber;
    string emailAddress;
    string role;
public:
    User(){
        this-> name="";
        this-> username="";
        this-> password="";
        this->phoneNumber="";
        this->emailAddress="";
        this->role="";
    }
    User( string name)
    {
        this-> name=name;
    }
    User(  string name,string username,string password,string phoneNumber,string emailAddress,string role){
        this-> name=name;
        this-> username=username;
        this-> password=password;
        this->phoneNumber=phoneNumber;
        this->emailAddress=emailAddress;
        this->role=role;
    }
    string pass;
    void login() {
        cout << "********( Welcome to Fayoum Library )********\nTo login ,please Enter your emailAddress: ";
        string em_ad;
        cin >> em_ad;
        cout << "Enter your password: ";
        cin >> pass;
        if (em_ad == this->emailAddress && pass == this->password) {
            cout << "( You have been successfully logged into your account. )\n";
        } else {
            int NumOfTrying = 3;
            while (NumOfTrying--) {
                cout << "( Your emailAddress or your password is incorrect ,Please try again. )\n";
                cout << "Enter your emailAddress:";
                cin >> em_ad;
                cout << "Enter your password:";
                cin >> pass;
                if (em_ad == this->emailAddress && pass == this->password) {
                    cout << "( You have been successfully logged into your account. )\n";
                    break;
                }
                if (NumOfTrying == 0) {
                    cout<< "( You have reached the maximum number of trying )\n ( Did you forget your emailAddress or your password ? )\n";
                    cout << "( If you forgot your emailAddress , use your phoneNumber. )\nEnter your phoneNumber:";
                    string ph_num;
                    cin >> ph_num;
                    if (ph_num == this->phoneNumber) {
                        cout << "Enter your password:";
                        cin >> pass;
                        if (pass == this->password) {
                            cout << "( Login completed successfully. )\n";
                            break;
                        } else {
                            cout
                                    << "( If you forgot your password ,change your password After a confirmation message is sent to your phone number. )\n";
                            const string confirmation_message = "123456";
                            cout <<"(Your confirmation message is :)" << confirmation_message << "\n";
;                            cout << "Enter your confirmation message:";
                            string massage;
                            cin >> massage;
                            if (confirmation_message == massage) {
                                cout << "( You can change your password ).\nwrite your new password:";
                                cin >> pass;
                                this->password = pass;
                                cout << "( The password has been changed successfully,Re-login. )\n";
                                break;
                            } else {
                                cout << "( Wrong code, failed to change password,try later. )\n";
                                break;
                            }
                        }
                    } else {
                        cout << "( This phoneNumber is invalid,try later. )\n";
                        break;
                    }
                }
            }

        }
    }
    void logout()
    {
        cout << "( Are you sure you want to logout ? yes/no )";
        string sure;
        cin >> sure;
        if(sure=="yes"||sure=="YES"||sure=="Yes")
        {
            cout << "( You have successfully logged out .)\n";
        }

    }
    void changePassword(){
        cout << " ( If you want to change your password ) Enter your old password :";
        cin >> pass;
        if(pass==this->password) {
            cout << "Enter your new password :";
            string new_pass;
            cin >> new_pass;
            this->password = new_pass;
            cout << "( The password has been changed successfully. )\n";
        }
        else
        {
            int num=3;
            while(num--){
                cout << "( Wrong password,try again. )\n";
                cout << " Enter your old password :";
                cin >> pass;
                if(pass==this->password) {
                    cout << "Enter your new password :";
                    string new_pass;
                    cin >> new_pass;
                    this->password = new_pass;
                    cout << "( The password has been changed successfully. )\n";
                    break;
                }
                if(num==0){
                    cout << "maximum trying ,failed!!\n";
                }
            }

        }

    }
};
class Book{
    string title;
    string author;
    string genre;
    static int num_of_copies;
public:
    Book(){
        this->title="";
        this->author="";
        this->genre="";
        this->num_of_copies=50;

    }
    Book( string title,string author,string genre,int num_of_copies){
        this->title=title;
        this->author=author;
        this->genre=genre;
        this->num_of_copies=num_of_copies;
    }
   void checkout() {
       cout << "\nEnter the title of the book you want to borrow :";
       string book_borrow;
       cin >> book_borrow;
       if(this->title==book_borrow) {
           if (num_of_copies > 0) {
               cout << "Available.\n";
               cout << "Enter the borrowing duration in days:";
               int borrowing_duration;
               cin >> borrowing_duration;
               if(borrowing_duration>30)
                   cout << "Not available It must be less than 31 days\n";
               else {
                   cout << " The total price is : " << borrowing_duration * 10 << "\n";
                   cout << "*****(Borrowing completed successfully)*****\n";
                   num_of_copies--;
               }
           } else {
               cout << "Sorry, this book is not available now.\n";
           }
       }
       else
           cout << "Not available in this library.\n";
   }
        void checkin(){
            cout << "\nEnter the title of the book you want to return :";
            string book_borrow;
            cin >> book_borrow;
            if(book_borrow==this->title){
                this->num_of_copies++;
            }
cout << "Returning process completed successfully\n";

        }
        void renew(){
            cout << "\nEnter the title of the book you want to renew :";
            string book_borrow;
            cin >> book_borrow;
            cout << "How many times have you done this process for this book?\n";
int num_renew;
cin >> num_renew;
if(num_renew>3) {
    cout << "Sorry ,you have done the maximum of this process.\n";
    if(book_borrow==this->title) { num_of_copies++; }
}
    else
{  cout << "Ok , it is available \n";
            cout << "Enter the borrowing duration in days:";
            int borrowing_duration;
            cin >> borrowing_duration;
    if(borrowing_duration>30)
        cout << "Not available It must be less than 31 days\n";
    else {
        cout << " The total price is : " << borrowing_duration * 10 << "\n";
        cout << "*****(Renewing process completed successfully)*****\n";
    }

}
    }
    bool isAvailable() {
        cout << "\nEnter the title of the book you want to know it is available :";
        string book_borrow;
        cin >> book_borrow;
        if (this->title == book_borrow&&num_of_copies>0) {
            cout << "This book is available.\n";
        } else
            cout << "This book is not available.\n";
    }
};
int Book::num_of_copies=0;
class Magazine{
    string title;
    string publisher;
    string  publicationDate;
    static int numberOfCopies;
public:

    Magazine(){
        this->title="";
        this->publisher="";
        this->publicationDate="";
        this->numberOfCopies=5;
    }
    Magazine(string title,string publisher,string  publicationDate,int numberOfCopies) {
        this->title = title;
        this->publisher = publisher;
        this->publicationDate = publicationDate;
        this->numberOfCopies = numberOfCopies;
    }
    void checkout() {
        cout << "\nEnter the title of the Magazine you want to borrow :";
        string book_borrow;
        cin >> book_borrow;
        if(this->title==book_borrow) {
            if (numberOfCopies > 0) {
                cout << "Available.\n";
                cout << "Enter the borrowing duration in days:";
                int borrowing_duration;
                cin >> borrowing_duration;
                if(borrowing_duration>30)
                    cout << "Not available It must be less than 31 days\n";
                else {
                    cout << " The total price is : " << borrowing_duration * 10 << "\n";
                    cout << "*****(Borrowing completed successfully)*****\n";
                    numberOfCopies--;
                }
            } else {
                cout << "Sorry, this magazine is not available now.\n";
            }
        }
        else
            cout << "Not available in this library.\n";
    }
    void checkin(){
        cout << "\nEnter the title of the magazine you want to return :";
        string magazine_borrow;
        cin >> magazine_borrow;
        if(magazine_borrow==this->title){
            this->numberOfCopies++;
        }
        cout << "Returning process completed successfully\n";
    }
    void renew() {
        cout << "\nEnter the title of the magazine you want to renew :";
        string magazine_borrow;
        cin >> magazine_borrow;
        cout << "How many times have you done this process for this magazine?\n";
        int num_renew;
        cin >> num_renew;
        if (num_renew > 3) {
            cout << "Sorry ,you have done the maximum of this process.\n";
            if (magazine_borrow == this->title) { numberOfCopies++; }
        } else {
            cout << "Ok , it is available \n";
            cout << "Enter the borrowing duration in days:";
            int borrowing_duration;
            cin >> borrowing_duration;
            if (borrowing_duration > 30)
                cout << "Not available It must be less than 31 days\n";
            else {
                cout << " The total price is : " << borrowing_duration * 10 << "\n";
                cout << "*****(Renewing process completed successfully)*****\n";
            }

        }
    }
    bool isAvailable() {
        cout << "\nEnter the title of the magazine you want to know it is available :";
        string magazine_borrow;
        cin >> magazine_borrow;
        if (this->title == magazine_borrow&&numberOfCopies>0) {
            cout << "This magazine is available.\n";
        } else
            cout << "This magazine is not available.\n";
    }

};
int Magazine::numberOfCopies=0;
class Patron:public User,public Book,public Magazine{
string  libraryCardNumber;
string adress;
public:
    Patron():User(){
       this->adress="" ;
    }
Patron( string name,string libraryCardNumber,string adress ): User(name)
{
    this->libraryCardNumber=libraryCardNumber;
    this->adress=adress;
}
void registerr(){
    cout <<"***(register)***\n";
    cout << "Enter your name :";
    cin >> name;
    cout << "Enter your username :";
    cin >> username;
    cout << "Enter your password :";
    cin >> password;
    cout << "Enter your phone number :";
    cin >> phoneNumber;
    cout << "Enter your emailAddress :";
cin >> emailAddress;
    cout << "Enter your role :";
cin >> role;
cout << "***(The account has been created successfully)***\n";
}


};
int main() {
   /* User c1("fatma","fatmaa","123123","012536478","fatma@gmail.com","patron");
    c1.login();
    c1.logout();
    c1.changePassword();
    cout << "\n--------------------------------------------------\n";
Book c2("elsa","jonny","comedy",2);
c2.checkout();//old=2,now=1
c2.checkout();//old=1,now=0
c2.checkin();//old=0,now=1
c2.checkout();//old=1,now=0
 c2.checkout();//old=0,now=0 not available to borrow
c2.renew();// if num of renew >3 old=0,now=1
 c2.checkout();//old=1,now=0
    c2.isAvailable();
     cout << "\n--------------------------------------------------\n";

    Magazine c3("frozen","tonny","2020/1/5",2);
    c3.checkout();//old=2,now=1
    c3.checkout();//old=1,now=0
    c3.checkin();//old=0,now=1
    c3.checkout();//old=1,now=0
    c3.checkout();//old=0,now=0 not available to borrow
    c3.isAvailable();
    cout << "\n--------------------------------------------------\n";
*/
    return 0;
}
